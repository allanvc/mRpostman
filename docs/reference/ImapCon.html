<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>An IMAP Connection Class — ImapCon • mRpostman</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="An IMAP Connection Class — ImapCon" />

<meta property="og:description" content="Configure an IMAP connection using the ImapCon R6
  class." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mRpostman</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basics.html">mRpostman basics</a>
    </li>
    <li>
      <a href="../articles/code_migration.html">Migrating old code to the new mRpostman's syntax</a>
    </li>
    <li>
      <a href="../articles/xoauth2.0.html">IMAP OAuth2.0 authentication in mRpostman</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>An IMAP Connection Class</h1>
    
    <div class="hidden name"><code>ImapCon.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Configure an IMAP connection using the <code>ImapCon</code> <code>R6</code>
  class.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><a href='#method-new'><code>ImapCon$new()</code></a>: The <code><a href='configure_imap.html'>configure_imap</a></code>
  should be preferred instead of <code>ImapCon$new()</code>.</p>
<p><a href='#method-search'><code>ImapCon$search()</code></a>: IMAP queries follows
  Polish notation, i.e. operators such as <code>OR</code> come before arguments,
  e.g. "OR argument1 argument2". Therefore, the relational-operator-helper-functions
  in this package should be used like the following examples:
  <code><a href='OR.html'>OR(before("17-Apr-2015"), string("FROM", "John"))</a></code>. Even though there
  is no "AND" operator in IMAP, this package adds a helper function
  <code><a href='AND.html'>AND</a></code> to indicate multiples arguments that must be searched
  together, e.g. <code><a href='AND.html'>AND(since("01-Jul-2018"), smaller_than(16000))</a></code>.</p>
<p><a href='#method-sent_before'><code>ImapCon$sent_before()</code></a>: Search
  operations that use the origination/RFC-2822 Header date
  tend to be "slower" than those that use the internal date. Although the
  overhead is minimum, the difference is due to the fact that the internal date
  is kept on a database, while the origination date has to be retrieved from
  inside the message. Therefore, the server needs to access each message when
  executing this type of search. Despite this fact, both dates tend to be the
  same.</p>
<p><a href='#method-search_sent_since'><code>ImapCon$search_sent_since()</code></a>: Search
  operations that use the origination/RFC-2822 Header date
  tend to be "slower" than those that use the internal date. Although the
  overhead is minimum, the difference is due to the fact that the internal date
  is kept on a database, while the origination date has to be retrieved from
  inside the message. Therefore, the server needs to access each message when
  executing this type of search. Despite this fact, both dates tend to be the
  same.</p>
<p><a href='#method-search_sent_on'><code>ImapCon$search_sent_on()</code></a>: Search
  operations that use the origination/RFC-2822 Header date
  tend to be "slower" than those that use the internal date. Although the
  overhead is minimum, the difference is due to the fact that the internal date
  is kept on a database, while the origination date has to be retrieved from
  inside the message. Therefore, the server needs to access each message when
  executing this type of search. Despite this fact, both dates tend to be the
  same.</p>
<p><a href='#method-search_sent_period'><code>ImapCon$search_sent_period()</code></a>: Search
  operations that use the origination/RFC-2822 Header date
  tend to be "slower" than those that use the internal date. Although the
  overhead is minimum, the difference is due to the fact that the internal date
  is kept on a database, while the origination date has to be retrieved from
  inside the message. Therefore, the server needs to access each message when
  executing this type of search. Despite this fact, both dates tend to be the
  same.</p>
<p><a href='#method-search_older_than'><code>ImapCon$search_older_than()</code></a>:
  To be able to use this functionality, the server must support the
  <code>WITHIN</code> capability. You can check it by running
  <a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p>
<p><a href='#method-search_older_than'><code>ImapCon$search_older_than()</code></a>:
  To be able to use this functionality, the server must support the
  <code>WITHIN</code> capability. You can check it by running
  <a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p>
<p><a href='#method-search_string'><code>ImapCon$search_string()</code></a>: Using
  <code>where = "TEXT"</code>, may produce unexpected results since it
  will perform the search on raw data, i.e. the searched expression may be
  truncated by special formating characters such as <code>\r\n</code> for example.
  It is recommended to perform this type of search using <code>where = "BODY"</code>,
  instead of <code>"TEXT"</code> (<cite>Heinlein, P. and Hartleben, P. (2008)</cite>).</p>
<p><a href='#method-esearch_count'><code>ImapCon$esearch_count()</code></a>: This
  operation depends on the <code>ESEARCH</code> extension.</p>
<p><a href='#method-esearch_min_id'><code>ImapCon$esearch_min_id()</code></a>: This
  operation depends on the <code>ESEARCH</code> extension.</p>
<p><a href='#method-esearch_max_id'><code>ImapCon$esearch_max_id()</code></a>: This
  operation depends on the <code>ESEARCH</code> extension.</p>
<p><a href='#method-add_flags'><code>ImapCon$add_flags()</code></a>: Unlike the
  search operations, the add/replace/delete flags operations
  demand that system flags' names be preceded by two backslashes <code>"\\"</code>.</p>
<p><a href='#method-add_flags'><code>ImapCon$add_flags()</code></a>: <code>add_flags</code>,
  <code>remove_flags</code>, and <code>replace_flags</code> accept not only flags but
  also keywords (any word not beginning with two backslashes) which are
  custom flags defined by the user.</p>
<p><a href='#method-replace_flags'><code>ImapCon$replace_flags()</code></a>: Unlike the
  search operations, the add/replace/delete flags operations
  demand that system-flags names be preceded by two backslashes <code>"\\"</code>.</p>
<p><a href='#method-replace_flags'><code>ImapCon$replace_flags()</code></a>: <code>add_flags</code>,
  <code>remove_flags</code>, and <code>replace_flags</code> accept not only flags but
  also keywords (any word not beginning with two backslashes) which are
  custom flags defined by the user.</p>
<p><a href='#method-remove_flags'><code>ImapCon$remove_flags()</code></a>: Unlike the
  search operations, the add/replace/delete flags operations
  demand that system-flags names be preceded by two backslashes <code>"\\"</code>.</p>
<p><a href='#method-remove_flags'><code>ImapCon$remove_flags()</code></a>: <code>add_flags</code>,
  <code>remove_flags</code>, and <code>replace_flags</code> accept not only flags but
  also keywords (any word not beginning with two backslashes) which are
  custom flags defined by the user.</p>
<p><a href='#method-get_attachments'><code>ImapCon$get_attachments()</code></a>:
  This method is to be used after the body or the
  text part of one or more messages were fetched. This makes sense if the
  user is interested in keeping the message content (body or text) besides
  downloading the message attachments. Nonetheless, this is not the
  recommended approach if the user is only interested in downloading the files
  as the previous fetching operation will probably be costly. In this last
  case, the recommendation is to use
  <a href='#method-fetch_attachments'><code>ImapCon$fetch_attachments()</code></a> as
  it will only fetch the attachment part.</p>
<p><a href='#method-get_attachments'><code>ImapCon$get_attachments()</code></a>: All
  attachments will be stored in a folder labeled with the message id
  inside the <code>working directory &gt; servername &gt; foldername</code>.
  This function currently handles only attachments
  encoded as <code>base64</code> text. It tries to guess all file extensions while
  decoding the text, but it may not be possible to do so in some circumstances.
  If it happens, you can try to change the file extension directly by renaming
  the file.</p>
<p><a href='#method-get_attachments'><code>ImapCon$get_attachments()</code></a>: The
  "Content-Disposition" header specifies if the multipart electronic
  messages will be presented as a main document with a list of separate
  attachments ("Content-Disposition: attachment") or as a single document
  with the various parts displayed inline. The first requires positive action
  on the part of the recipient (downloading the file, for example) whereas inline
  components are displayed automatically when the message is viewed
  (<cite>Troost, R., Dorner, S., and K. Moore, Ed. (1997)</cite>). You can choose
  to download <code>both</code>, or only one type of attachment, using the
  argument <code>content_disposition</code>.</p>
<p><a href='#method-fetch_attachments'><code>ImapCon$fetch_attachments()</code></a>: All
  attachments will be stored in a folder labeled with the message id
  inside the <code>working directory &gt; servername &gt; foldername</code>.
  This function currently handles only attachments
  encoded as <code>base64</code> text. It tries to guess all file extensions while
  decoding the text, but it may not be possible to do so in some circumstances.
  If it happens, you can try to change the file extension directly by renaming
  the file.</p>
<p><a href='#method-fetch_attachments'><code>ImapCon$fetch_attachments()</code></a>: The
  "Content-Disposition" header specifies if the multipart electronic
  messages will be presented as a main document with a list of separate
  attachments ("Content-Disposition: attachment") or as a single document
  with the various parts displayed inline. The first requires positive action
  on the part of the recipient (downloading the file, for example) whereas inline
  components are displayed automatically when the message is viewed
  (<cite>Troost, R., Dorner, S., and K. Moore, Ed. (1997)</cite>). You can choose
  to download <code>both</code>, or only one type of attachment, using the
  argument <code>content_disposition</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='#method-search_string'><code>ImapCon$search_string()</code></a>:
  Heinlein, P. and Hartleben, P. (2008). The Book of IMAP: Building a
  Mail Server with Courier and Cyrus. No Starch Press. ISBN 978-1-59327-177-0.</p>
<p><a href='#method-get_attachments'><code>ImapCon$get_attachments()</code></a>:
  Troost, R., Dorner, S., and K. Moore (1997), Communicating
  Presentation Information in Internet Messages: The Content-Disposition
  Header Field, RFC 2183, August 1997, https://tools.ietf.org/html/rfc2183.</p>
<p><a href='#method-fetch_attachments'><code>ImapCon$fetch_attachments()</code></a>:
  Troost, R., Dorner, S., and K. Moore (1997), Communicating
  Presentation Information in Internet Messages: The Content-Disposition
  Header Field, RFC 2183, DOI 10.17487/RFC2183, August 1997,
  https://tools.ietf.org/html/rfc2183.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other custom search: 
<code><a href='AND.html'>AND</a>()</code>,
<code><a href='OR.html'>OR</a>()</code>,
<code><a href='before.html'>before</a>()</code>,
<code><a href='flag.html'>flag</a>()</code>,
<code><a href='larger_than.html'>larger_than</a>()</code>,
<code><a href='older_than.html'>older_than</a>()</code>,
<code><a href='on.html'>on</a>()</code>,
<code><a href='sent_before.html'>sent_before</a>()</code>,
<code><a href='sent_on.html'>sent_on</a>()</code>,
<code><a href='sent_since.html'>sent_since</a>()</code>,
<code><a href='since.html'>since</a>()</code>,
<code><a href='smaller_than.html'>smaller_than</a>()</code>,
<code><a href='string.html'>string</a>()</code>,
<code><a href='younger_than.html'>younger_than</a>()</code></p>
<p>Other attachments: 
<code><a href='list_attachments.html'>list_attachments</a>()</code></p></div>
    
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    <h3>Public methods</h3>
    <ul>
<li><p><a href='#method-new'><code>ImapCon$new()</code></a></p></li>
<li><p><a href='#method-reset_url'><code>ImapCon$reset_url()</code></a></p></li>
<li><p><a href='#method-reset_username'><code>ImapCon$reset_username()</code></a></p></li>
<li><p><a href='#method-reset_ssl'><code>ImapCon$reset_ssl()</code></a></p></li>
<li><p><a href='#method-reset_verbose'><code>ImapCon$reset_verbose()</code></a></p></li>
<li><p><a href='#method-reset_buffersize'><code>ImapCon$reset_buffersize()</code></a></p></li>
<li><p><a href='#method-reset_timeout_ms'><code>ImapCon$reset_timeout_ms()</code></a></p></li>
<li><p><a href='#method-reset_password'><code>ImapCon$reset_password()</code></a></p></li>
<li><p><a href='#method-reset_xoauth2_bearer'><code>ImapCon$reset_xoauth2_bearer()</code></a></p></li>
<li><p><a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a></p></li>
<li><p><a href='#method-list_mail_folders'><code>ImapCon$list_mail_folders()</code></a></p></li>
<li><p><a href='#method-select_folder'><code>ImapCon$select_folder()</code></a></p></li>
<li><p><a href='#method-examine_folder'><code>ImapCon$examine_folder()</code></a></p></li>
<li><p><a href='#method-create_folder'><code>ImapCon$create_folder()</code></a></p></li>
<li><p><a href='#method-rename_folder'><code>ImapCon$rename_folder()</code></a></p></li>
<li><p><a href='#method-list_flags'><code>ImapCon$list_flags()</code></a></p></li>
<li><p><a href='#method-search'><code>ImapCon$search()</code></a></p></li>
<li><p><a href='#method-search_larger_than'><code>ImapCon$search_larger_than()</code></a></p></li>
<li><p><a href='#method-search_smaller_than'><code>ImapCon$search_smaller_than()</code></a></p></li>
<li><p><a href='#method-search_before'><code>ImapCon$search_before()</code></a></p></li>
<li><p><a href='#method-search_since'><code>ImapCon$search_since()</code></a></p></li>
<li><p><a href='#method-search_on'><code>ImapCon$search_on()</code></a></p></li>
<li><p><a href='#method-search_period'><code>ImapCon$search_period()</code></a></p></li>
<li><p><a href='#method-search_sent_before'><code>ImapCon$search_sent_before()</code></a></p></li>
<li><p><a href='#method-search_sent_since'><code>ImapCon$search_sent_since()</code></a></p></li>
<li><p><a href='#method-search_sent_on'><code>ImapCon$search_sent_on()</code></a></p></li>
<li><p><a href='#method-search_sent_period'><code>ImapCon$search_sent_period()</code></a></p></li>
<li><p><a href='#method-search_flag'><code>ImapCon$search_flag()</code></a></p></li>
<li><p><a href='#method-search_older_than'><code>ImapCon$search_older_than()</code></a></p></li>
<li><p><a href='#method-search_younger_than'><code>ImapCon$search_younger_than()</code></a></p></li>
<li><p><a href='#method-search_string'><code>ImapCon$search_string()</code></a></p></li>
<li><p><a href='#method-fetch_body'><code>ImapCon$fetch_body()</code></a></p></li>
<li><p><a href='#method-fetch_header'><code>ImapCon$fetch_header()</code></a></p></li>
<li><p><a href='#method-fetch_metadata'><code>ImapCon$fetch_metadata()</code></a></p></li>
<li><p><a href='#method-fetch_text'><code>ImapCon$fetch_text()</code></a></p></li>
<li><p><a href='#method-copy_msg'><code>ImapCon$copy_msg()</code></a></p></li>
<li><p><a href='#method-move_msg'><code>ImapCon$move_msg()</code></a></p></li>
<li><p><a href='#method-esearch_count'><code>ImapCon$esearch_count()</code></a></p></li>
<li><p><a href='#method-delete_msg'><code>ImapCon$delete_msg()</code></a></p></li>
<li><p><a href='#method-expunge'><code>ImapCon$expunge()</code></a></p></li>
<li><p><a href='#method-esearch_min_id'><code>ImapCon$esearch_min_id()</code></a></p></li>
<li><p><a href='#method-esearch_max_id'><code>ImapCon$esearch_max_id()</code></a></p></li>
<li><p><a href='#method-add_flags'><code>ImapCon$add_flags()</code></a></p></li>
<li><p><a href='#method-replace_flags'><code>ImapCon$replace_flags()</code></a></p></li>
<li><p><a href='#method-remove_flags'><code>ImapCon$remove_flags()</code></a></p></li>
<li><p><a href='#method-get_attachments'><code>ImapCon$get_attachments()</code></a></p></li>
<li><p><a href='#method-fetch_attachments_list'><code>ImapCon$fetch_attachments_list()</code></a></p></li>
<li><p><a href='#method-fetch_attachments'><code>ImapCon$fetch_attachments()</code></a></p></li>
<li><p><a href='#method-clone'><code>ImapCon$clone()</code></a></p></li>
</ul>
<p><hr>
<a id="method-new"></a></p><h3>Method <code>new()</code></h3>
    Configure and create a new IMAP connection.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$new(
  url,
  username,
  password = NULL,
  xoauth2_bearer = NULL,
  use_ssl = TRUE,
  verbose = FALSE,
  buffersize = 16000,
  timeout_ms = 5000,
  ...
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>url</code></dt><dd><p>A character string containing the IMAP server address</p></dd>
    <dt><code>username</code></dt><dd><p>A character string containing the username.</p></dd>
    <dt><code>password</code></dt><dd><p>A character string containing the user's password.</p></dd>
    <dt><code>xoauth2_bearer</code></dt><dd><p>A character string containing the oauth2 bearer token.</p></dd>
    <dt><code>use_ssl</code></dt><dd><p>A logical indicating the use or not of Secure Sockets Layer
encryption when connecting to the IMAP server. Default is <code>TRUE</code>.</p></dd>
    <dt><code>verbose</code></dt><dd><p>If <code>FALSE</code>, mutes the flow of information between the
server and the client. Default is <code>FALSE</code>.</p></dd>
    <dt><code>buffersize</code></dt><dd><p>The size in bytes for the receive buffer. Default is
16000 bytes or 16kb, which means it will use the libcurl's default value.
According to the libcurl's documentation, the maximum buffersize is 512kb
(or 512000 bytes), but any number passed to <code>buffersize</code> is treated
as a request, not an order.</p></dd>
    <dt><code>timeout_ms</code></dt><dd><p>Time in milliseconds (ms) to wait for the execution or
re-execution of a command. Default is 5000ms (or 5 seconds). If a first
execution is unsuccessful, an error handler in each function (depending on
the <code>retries</code> value), will try to reconnect or re-execute the command.</p></dd>
    <dt><code>...</code></dt><dd><p>Further curl parameters (see <code><a href='https://jeroen.cran.dev/curl/reference/curl_options.html'>curl::curl_options</a></code>) that
can be used with the IMAP protocol. Only for advanced users.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A new `ImapCon` object.
    <p><hr>
<a id="method-reset_url"></a></p><h3>Method <code>reset_url()</code></h3>
    Reset the previously informed url
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_url(url)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>url</code></dt><dd><p>A character string containing a new url to be set.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-reset_username"></a></p><h3>Method <code>reset_username()</code></h3>
    Reset the previously informed username
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_username(username)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>username</code></dt><dd><p>A character string containing a new username to be set.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-reset_ssl"></a></p><h3>Method <code>reset_ssl()</code></h3>
    Reset the previously informed use_ssl parameter
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_ssl(use_ssl)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>use_ssl</code></dt><dd><p>A logical indicating the use or not of Secure Sockets Layer
encryption when connecting to the IMAP server. Default is <code>TRUE</code>.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-reset_verbose"></a></p><h3>Method <code>reset_verbose()</code></h3>
    Reset the previously informed verbose parameter
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_verbose(verbose)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>verbose</code></dt><dd><p>If <code>FALSE</code>, mutes the flow of information between the
server and the client.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-reset_buffersize"></a></p><h3>Method <code>reset_buffersize()</code></h3>
    Reset the previously informed buffersize parameter
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_buffersize(buffersize)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>buffersize</code></dt><dd><p>The size in bytes for the receive buffer. Default is
16000 bytes or 16kb, which means it will use the libcurl's default value.
According to the libcurl's documentation, the maximum buffersize is 512kb
(or 512000 bytes), but any number passed to <code>buffersize</code> is treated
as a request, not an order.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-reset_timeout_ms"></a></p><h3>Method <code>reset_timeout_ms()</code></h3>
    Reset the previously informed buffersize parameter
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_timeout_ms(timeout_ms)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>timeout_ms</code></dt><dd><p>Time in milliseconds (ms) to wait for the execution or
re-xecution of a command. Default is 5000ms (or 5 seconds). If a first
execution is unsuccessful, an error handler in each function (depending on
the <code>retries</code> value), will try to reconnect or re-execute the command.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-reset_password"></a></p><h3>Method <code>reset_password()</code></h3>
    Reset the previously informed password
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_password(password)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>password</code></dt><dd><p>A character string containing the user's password.</p></dd>
    <dt><code>xoauth2_bearer</code></dt><dd><p>A character string containing the oauth2 bearer token.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-reset_xoauth2_bearer"></a></p><h3>Method <code>reset_xoauth2_bearer()</code></h3>
    Reset the previously informed oauth2 bearer token
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$reset_xoauth2_bearer(xoauth2_bearer)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>xoauth2_bearer</code></dt><dd><p>A character string containing the oauth2 bearer token.</p></dd>
</dl>
</div>
    <p><hr>
<a id="method-list_server_capabilities"></a></p><h3>Method <code>list_server_capabilities()</code></h3>
    List the server's IMAP capabilities.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$list_server_capabilities(retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A character <code>vector</code> containing the server's IMAP capabilities.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
cap &lt;- con$list_server_capabilities()
cap
}
</pre>
</div>
    <p><hr>
<a id="method-list_mail_folders"></a></p><h3>Method <code>list_mail_folders()</code></h3>
    List mail folders in a mailbox.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$list_mail_folders(retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> containing the mail folder names and their inherent
  structure.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
folders &lt;- con$list_mail_folders()
folders
}
</pre>
</div>
    <p><hr>
<a id="method-select_folder"></a></p><h3>Method <code>select_folder()</code></h3>
    Select a mail folder.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$select_folder(name, mute = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>name</code></dt><dd><p>A string containing the name of an existing mail folder on the
user's mailbox.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> containing the mail folder names and their inherent
  structure.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_mail_folder(name = "INBOX")
}
</pre>
</div>
    <p><hr>
<a id="method-examine_folder"></a></p><h3>Method <code>examine_folder()</code></h3>
    Examine the number of messages in a mail folder.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$examine_folder(name = NULL, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>name</code></dt><dd><p>A <code>character</code> string containing the name of an existing
mail folder on the user's mailbox. If no name is passed, the command
will be executed using the previously selected mail folder name.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>vector</code> (with names <code>"EXISTS"</code> and <code>"RECENT"</code>)
  containing the number of messages in each category.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
con$examine_folder()
    # or directly:
con$examine_folder("Sent")
}
</pre>
</div>
    <p><hr>
<a id="method-create_folder"></a></p><h3>Method <code>create_folder()</code></h3>
    Create a new mail folder.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$create_folder(name, mute = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>name</code></dt><dd><p>A string containing the name of the new mail folder to be
created.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    <code>TRUE</code> in case the operation is successful.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$create_folder(name = "New Folder Name")
}
</pre>
</div>
    <p><hr>
<a id="method-rename_folder"></a></p><h3>Method <code>rename_folder()</code></h3>
    Rename a mail folder.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$rename_folder(
  name = NULL,
  new_name,
  reselect = TRUE,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>name</code></dt><dd><p>A string containing the name of the new mail folder to be
renamed. If no name is passed, the command will be executed using the
previously selected mail folder name.</p></dd>
    <dt><code>new_name</code></dt><dd><p>A string containing the new name to be assigned.</p></dd>
    <dt><code>reselect</code></dt><dd><p>A logical. If <code>TRUE</code>, calls
<code>select_folder(name = to_folder)</code> under the hood before returning
the output. Default is <code>TRUE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    <code>TRUE</code> in case the operation is successful.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "Folder A")
con$rename_folder(new_name = "Folder B")
# or directly:
con$rename_folder(name = "Folder A", new_name = "Folder B")
}
</pre>
</div>
    <p><hr>
<a id="method-list_flags"></a></p><h3>Method <code>list_flags()</code></h3>
    List flags in a selected mail folder
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$list_flags(retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    <code>TRUE</code> in case the operation is successful.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
con$list_flags()
}
</pre>
</div>
    <p><hr>
<a id="method-search"></a></p><h3>Method <code><a href='https://www.rdocumentation.org/packages/base/topics/search'>search()</a></code></h3>
    Execute a custom search
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search(
  request,
  negate = FALSE,
  use_uid = FALSE,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>request</code></dt><dd><p>A string directly specifying what to search or
constructed by a combination of relational-operator-helper-functions <code><a href='OR.html'>OR</a></code>
and <code><a href='AND.html'>AND</a></code>, and criteria helper functions such as
<code><a href='before.html'>before</a></code>, <code><a href='since.html'>since</a></code>, <code><a href='on.html'>on</a></code>,
<code><a href='sent_before.html'>sent_before</a></code>, <code><a href='sent_since.html'>sent_since</a></code>, <code><a href='sent_on.html'>sent_on</a></code>,
<code><a href='flag.html'>flag</a></code>, <code><a href='string.html'>string</a></code>, <code><a href='smaller_than.html'>smaller_than</a></code>,
<code><a href='larger_than.html'>larger_than</a></code>, <code><a href='younger_than.html'>younger_than</a></code>, or
<code><a href='younger_than.html'>younger_than</a></code>.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERIA". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> containing the flags (<code>character vector</code>),
  the permanent flags (<code>character vector</code>), and an indication if custom
  flags are allowed by the server (<code>logical vector</code>).
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# ex1
con$search(OR(before(date_char = "17-Apr-2015"),
              string(expr = "John", where = "FROM")))
    # ex2
con$search(AND(smaller_than(size = "512000"),
               string(expr = "John", where = "FROM"),
               string(expr = "@ksu.edu", where = "CC")))
}
</pre>
</div>
    <p><hr>
<a id="method-search_larger_than"></a></p><h3>Method <code>search_larger_than()</code></h3>
    Search by size (LARGER)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_larger_than(
  size,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>size</code></dt><dd><p>An integer specifying the number of seconds to be used as the
search criterion.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
# search for messages with size larger than 512Kb
con$search_larger_than(size = 512000))
}
</pre>
</div>
    <p><hr>
<a id="method-search_smaller_than"></a></p><h3>Method <code>search_smaller_than()</code></h3>
    Search by size (SMALLER)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_smaller_than(
  size,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>size</code></dt><dd><p>An integer specifying the number of seconds to be used as the
search criterion.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for messages with size smaller than 512Kb
con$search_smaller_than(size = 512000))
}
</pre>
</div>
    <p><hr>
<a id="method-search_before"></a></p><h3>Method <code>search_before()</code></h3>
    Search by internal date (BEFORE)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_before(
  date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for messages with date before "02-Jan-2020", presenting the
# .. results as unique identifiers (UID)
con$search_before(date = "02-Jan-2020", use_uid = TRUE)
}
</pre>
</div>
    <p><hr>
<a id="method-search_since"></a></p><h3>Method <code>search_since()</code></h3>
    Search by internal date (SINCE)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_since(
  date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.
<code>POSIX*</code> like objects, since IMAP servers use this unusual date format.
<code>POSIX*</code> like, since IMAP servers like this not so common date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for messages with date since "02-Jan-2020", presenting the
# .. results as unique identifiers (UID)
con$search_since(date = "02-Jan-2020", use_uid = TRUE)
}
</pre>
</div>
    <p><hr>
<a id="method-search_on"></a></p><h3>Method <code>search_on()</code></h3>
    Search by internal date (ON)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_on(
  date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for messages received on date "02-Jan-2020", presenting the
#... results as unique identifiers (UID)
con$search_on(date = "02-Jan-2020", use_uid = TRUE)
}
</pre>
</div>
    <p><hr>
<a id="method-search_period"></a></p><h3>Method <code>search_period()</code></h3>
    Search by internal date (Period)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_period(
  since_date_char,
  before_date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>since_date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>before_date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for all messages in the mail folder, EXCEPT (negate = TRUE) by
#... those received between the dates "02-Jan-2020" and "22-Mar-2020"
con$search_period(since_date_char = "02-Jan-2020",
                  before_date_char = "22-Mar-2020",
                  negate = TRUE))
}
</pre>
</div>
    <p><hr>
<a id="method-search_sent_before"></a></p><h3>Method <code>search_sent_before()</code></h3>
    Search by origination (RFC-2822 Header) date (SENT BEFORE)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_sent_before(
  date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
# search for messages with date before "02-Jan-2020", presenting the
# .. results as unique identifiers (UID)
con$search_sent_before(date = "02-Jan-2020", use_uid = TRUE)
}
</pre>
</div>
    <p><hr>
<a id="method-search_sent_since"></a></p><h3>Method <code>search_sent_since()</code></h3>
    Search by origination (RFC-2822 Header) date (SENT SINCE)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_sent_since(
  date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
# search for messages with date before "02-Jan-2020", presenting the
# .. results as unique identifiers (UID)
con$search_sent_since(date = "02-Jan-2020", use_uid = TRUE)
}
</pre>
</div>
    <p><hr>
<a id="method-search_sent_on"></a></p><h3>Method <code>search_sent_on()</code></h3>
    Search by origination (RFC-2822 Header) date (SENT ON)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_sent_on(
  date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for messages received on date "02-Jan-2020", presenting the
#... results as unique identifiers (UID)
con$search_sent_on(date = "02-Jan-2020", use_uid = TRUE)
}
</pre>
</div>
    <p><hr>
<a id="method-search_sent_period"></a></p><h3>Method <code>search_sent_period()</code></h3>
    Search by origination (RFC-2822 Header) date (SENT Period)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_sent_period(
  since_date_char,
  before_date_char,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>since_date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>before_date_char</code></dt><dd><p>A <code>character string</code> with format "DD-Mon-YYYY", e.g.
"01-Apr-2019". We opted for not to use <code>Date</code> or <code>POSIX*</code> like
objects, since IMAP servers use this unusual date format.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for all messages in the mail folder, EXCEPT (negate = TRUE) by
#... those received between the dates "02-Jan-2020" and "22-Mar-2020"
con$search_sent_period(since_date_char = "02-Jan-2020",
                  before_date_char = "22-Mar-2020",
                  negate = TRUE))
}
</pre>
</div>
    <p><hr>
<a id="method-search_flag"></a></p><h3>Method <code>search_flag()</code></h3>
    Search by flag(s)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_flag(
  name,
  negate = FALSE,
  use_uid = FALSE,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>name</code></dt><dd><p>A string containing one or more flags to search for. Use
<a href='#method-list_flags'><code>ImapCon$list_flags()</code></a> to list the flags
in a selected mail folder.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for all messages in the mail folder that are marked as "SEEN" AND
#.. "ANSWERED"
con$search_flag(name = c("SEEN", "ANSWERED"))
}
</pre>
</div>
    <p><hr>
<a id="method-search_older_than"></a></p><h3>Method <code>search_older_than()</code></h3>
    Search WITHIN a specific time (OLDER)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_older_than(
  seconds,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>seconds</code></dt><dd><p>An integer specifying the number of seconds to be used as
the search criterion.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for all messages received in the last hour (not older than 3600 seconds)
con$search_older_than(seconds = 3600, negate = TRUE)
}
</pre>
</div>
    <p><hr>
<a id="method-search_younger_than"></a></p><h3>Method <code>search_younger_than()</code></h3>
    Search WITHIN a specific time (YOUNGER)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_younger_than(
  seconds,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>seconds</code></dt><dd><p>An integer specifying the number of seconds to be used as
the search criterion.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for all messages received in the last hour (younger than 3600 seconds)
con$search_younger_than(seconds = 3600)
}
</pre>
</div>
    <p><hr>
<a id="method-search_string"></a></p><h3>Method <code>search_string()</code></h3>
    Search by string or expression
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$search_string(
  expr,
  where,
  negate = FALSE,
  use_uid = FALSE,
  flag = NULL,
  esearch = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>expr</code></dt><dd><p>A character string specifying the word or expression to search
for in messages.</p></dd>
    <dt><code>where</code></dt><dd><p>A mandatory character string specifying in which
message's Section or Header Field to search for the provided string.</p></dd>
    <dt><code>negate</code></dt><dd><p>If <code>TRUE</code>, negates the search and seeks for "NOT SEARCH
CRITERION". Default is <code>FALSE</code>.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>flag</code></dt><dd><p>An optional argument that sets one or more flags as an additional
filter to the search. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder. Default is <code>NULL</code>.</p></dd>
    <dt><code>esearch</code></dt><dd><p>A logical. Default is <code>FALSE</code>. If the IMAP server has
<code>ESEARCH</code> capability, it can be used to optimize search results. It
will condense the results: instead of writing down the whole sequences of messages'
ids, such as <code>{1 2 3 4 5}</code>, it will be presented as <code>{1:5}</code>,
which decreases transmission costs. This argument can be used along with
<code>buffersize</code> to avoid results stripping. Check if your IMAP server
supports <code>ESEARCH</code> with
<a href='#method-list_server_capabilities'><code>ImapCon$list_server_capabilities()</code></a>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# search for all messages received in the last hour (younger than 3600 seconds)
con$search_string(expr = "@k-state.edu", where = "FROM")
}
</pre>
</div>
    <p><hr>
<a id="method-fetch_body"></a></p><h3>Method <code>fetch_body()</code></h3>
    Fetch message body (message's full content)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$fetch_body(
  msg_id,
  use_uid = FALSE,
  peek = TRUE,
  partial = NULL,
  write_to_disk = FALSE,
  keep_in_mem = TRUE,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>peek</code></dt><dd><p>If <code>TRUE</code>, it does not mark messages as "read" after
fetching. Default is <code>TRUE</code>.</p></dd>
    <dt><code>partial</code></dt><dd><p><code>NULL</code> or a character string with format
"startchar.endchar" indicating the size (in characters) of a message slice
to fetch. Default is <code>NULL</code>, which will fetch the full specified content.</p></dd>
    <dt><code>write_to_disk</code></dt><dd><p>If <code>TRUE</code>, writes the fetched content of each message
to a text file in a local folder inside the working directory, also
returning the results with <code><a href='https://www.rdocumentation.org/packages/base/topics/invisible'>invisible()</a></code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>keep_in_mem</code></dt><dd><p>If <code>TRUE</code>, keeps a copy of each fetch result while
the operation is being performed with <code>write_to_disk = TRUE</code>. Default
is <code>FALSE</code>, and it can only be set <code>TRUE</code> when
<code>write_to_disk = TRUE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. It provides a confirmation message if the
command is successfully executed. It is only effective when <code>write_to_disk = TRUE</code>
and <code>keep_in_mem = FALSE</code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command. Default
is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> with the fetch contents or a logical if
  <code>write_to_disk = TRUE</code> and <code>keep_in_mem = FALSE</code>.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and fetch the results (saving to disk) using the pipe
con$search_string(expr = "@k-state.edu", where = "FROM") %&gt;%
  con$fetch_body(write_to_disk = TRUE, keep_in_mem = FALSE)
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "FROM")
    con$fetch_body(msg = res, write_to_disk = TRUE, keep_in_mem = FALSE)
    }
</pre>
</div>
    <p><hr>
<a id="method-fetch_header"></a></p><h3>Method <code>fetch_header()</code></h3>
    Fetch message header
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$fetch_header(
  msg_id,
  use_uid = FALSE,
  fields = NULL,
  negate_fields = FALSE,
  peek = TRUE,
  partial = NULL,
  write_to_disk = FALSE,
  keep_in_mem = TRUE,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>fields</code></dt><dd><p>An optional <code>character vector</code> specifying which field(s)
will be fetched from the message's header. If none is specified, it will
fetch the full header.</p></dd>
    <dt><code>negate_fields</code></dt><dd><p>If <code>TRUE</code>, negates the operation and seeks for
"NOT in the field". Default is <code>FALSE</code>.</p></dd>
    <dt><code>peek</code></dt><dd><p>If <code>TRUE</code>, it does not mark messages as "read" after
fetching. Default is <code>TRUE</code>.</p></dd>
    <dt><code>partial</code></dt><dd><p><code>NULL</code> or a character string with format
"startchar.endchar" indicating the size (in characters) of a message slice
to fetch. Default is <code>NULL</code>, which will fetch the full specified content.</p></dd>
    <dt><code>write_to_disk</code></dt><dd><p>If <code>TRUE</code>, writes the fetched content of each message
to a text file in a local folder inside the working directory, also
returning the results with <code><a href='https://www.rdocumentation.org/packages/base/topics/invisible'>invisible()</a></code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>keep_in_mem</code></dt><dd><p>If <code>TRUE</code>, keeps a copy of each fetch result while
the operation is being performed with <code>write_to_disk = TRUE</code>. Default
is <code>FALSE</code>, and it can only be set <code>TRUE</code> when
<code>write_to_disk = TRUE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. It provides a confirmation message if the
command is successfully executed. It is only effective when <code>write_to_disk = TRUE</code>
and <code>keep_in_mem = FALSE</code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command. Default
is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> with the fetch contents or a logical if
  <code>write_to_disk = TRUE</code> and <code>keep_in_mem = FALSE</code>.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and fetch the results (also saving to disk) using the pipe
out &lt;- con$search_string(expr = "@k-state.edu", where = "CC") %&gt;%
  con$fetch_header()
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "CC")
out &lt;- con$fetch_header()
    }
</pre>
</div>
    <p><hr>
<a id="method-fetch_metadata"></a></p><h3>Method <code>fetch_metadata()</code></h3>
    Fetch message metadata
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$fetch_metadata(
  msg_id,
  use_uid = FALSE,
  metadata = NULL,
  write_to_disk = FALSE,
  keep_in_mem = TRUE,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>metadata</code></dt><dd><p>An optional <code>character vector</code> specifying one or more
items of the metadata of a message to fetch. See <a href='metadata_options.html'>metadata_options</a>.</p></dd>
    <dt><code>write_to_disk</code></dt><dd><p>If <code>TRUE</code>, writes the fetched content of each message
to a text file in a local folder inside the working directory, also
returning the results with <code><a href='https://www.rdocumentation.org/packages/base/topics/invisible'>invisible()</a></code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>keep_in_mem</code></dt><dd><p>If <code>TRUE</code>, keeps a copy of each fetch result while
the operation is being performed with <code>write_to_disk = TRUE</code>. Default
is <code>FALSE</code>, and it can only be set <code>TRUE</code> when
<code>write_to_disk = TRUE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. It provides a confirmation message if the
command is successfully executed. It is only effective when <code>write_to_disk = TRUE</code>
and <code>keep_in_mem = FALSE</code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command. Default
is <code>1</code>.</p></dd>
    <dt><code>peek</code></dt><dd><p>If <code>TRUE</code>, it does not mark messages as "read" after
fetching. Default is <code>TRUE</code>.</p></dd>
    <dt><code>partial</code></dt><dd><p><code>NULL</code> or a character string with format
"startchar.endchar" indicating the size (in characters) of a message slice
to fetch. Default is <code>NULL</code>, which will fetch the full specified content.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> with the fetch contents or a logical if
  <code>write_to_disk = TRUE</code> and <code>keep_in_mem = FALSE</code>.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and fetch the results using the pipe
out &lt;- con$search_string(expr = "@k-state.edu", where = "FROM") %&gt;%
  con$fetch_metadata()
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "FROM")
out &lt;- con$fetch_metadata(msg = res)
    }
</pre>
</div>
    <p><hr>
<a id="method-fetch_text"></a></p><h3>Method <code>fetch_text()</code></h3>
    Fetch message text
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$fetch_text(
  msg_id,
  use_uid = FALSE,
  peek = TRUE,
  partial = NULL,
  write_to_disk = FALSE,
  keep_in_mem = TRUE,
  mute = FALSE,
  base64_decode = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>peek</code></dt><dd><p>If <code>TRUE</code>, it does not mark messages as "read" after
fetching. Default is <code>TRUE</code>.</p></dd>
    <dt><code>partial</code></dt><dd><p><code>NULL</code> or a character string with format
"startchar.endchar" indicating the size (in characters) of a message slice
to fetch. Default is <code>NULL</code>, which will fetch the full specified content.</p></dd>
    <dt><code>write_to_disk</code></dt><dd><p>If <code>TRUE</code>, writes the fetched content of each message
to a text file in a local folder inside the working directory, also
returning the results with <code><a href='https://www.rdocumentation.org/packages/base/topics/invisible'>invisible()</a></code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>keep_in_mem</code></dt><dd><p>If <code>TRUE</code>, keeps a copy of each fetch result while
the operation is being performed with <code>write_to_disk = TRUE</code>. Default
is <code>FALSE</code>, and it can only be set <code>TRUE</code> when
<code>write_to_disk = TRUE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. It provides a confirmation message if the
command is successfully executed. It is only effective when <code>write_to_disk = TRUE</code>
and <code>keep_in_mem = FALSE</code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>base64_decode</code></dt><dd><p>If <code>TRUE</code>, tries to guess and decode the fetched
text from base64 format to <code>character</code>. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command. Default
is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> with the fetch contents or a logical if
  <code>write_to_disk = TRUE</code> and <code>keep_in_mem = FALSE</code>.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and partially fetch the results using the pipe
# first 200 characters, writing to disk, silence results in the console
con$search_string(expr = "@k-state.edu", where = "FROM") %&gt;%
  con$fetch_text(partial = "0.200",
                 write_to_disk = TRUE,
                 keep_in_mem = FALSE)
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "FROM")
con$fetch_text(msg = res,
               partial = "0.200",
               write_to_disk = TRUE,
               keep_in_mem = FALSE)
    }
</pre>
</div>
    <p><hr>
<a id="method-copy_msg"></a></p><h3>Method <code>copy_msg()</code></h3>
    Copy message(s) between the selected folder and another one
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$copy_msg(
  msg_id,
  use_uid = FALSE,
  to_folder,
  reselect = TRUE,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>to_folder</code></dt><dd><p>A <code>character</code> string specifying the folder to which
the messages will be copied.</p></dd>
    <dt><code>reselect</code></dt><dd><p>A logical. If <code>TRUE</code>, calls
<a href='#method-select_folder'><code>ImapCon$select_folder(name = to_folder)</code></a>
under the hood before returning the output. Default is <code>TRUE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    An invisible <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and copy the results to another folder
con$search_string(expr = "@k-state.edu", where = "FROM") %&gt;%
  con$copy(to_folder = "Sent")
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "FROM")
con$copy(msg = res, to_folder = "Sent")
    }
</pre>
</div>
    <p><hr>
<a id="method-move_msg"></a></p><h3>Method <code>move_msg()</code></h3>
    Move message(s) between the selected folder and another one
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$move_msg(
  msg_id,
  use_uid = FALSE,
  to_folder,
  reselect = TRUE,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>to_folder</code></dt><dd><p>A <code>character</code> string specifying the folder to which
the messages will be copied.</p></dd>
    <dt><code>reselect</code></dt><dd><p>A logical. If <code>TRUE</code>, calls
<a href='#method-select_folder'><code>ImapCon$select_folder(name = to_folder)</code></a>
under the hood before returning the output. Default is <code>TRUE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    An invisible <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and copy the results to another folder
con$search_string(expr = "@k-state.edu", where = "FROM") %&gt;%
  con$move(to_folder = "Sent")
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "FROM")
con$move(msg = res, to_folder = "Sent")
    }
</pre>
</div>
    <p><hr>
<a id="method-esearch_count"></a></p><h3>Method <code>esearch_count()</code></h3>
    Count the number of messages with a specific flag(s) in a
  folder (depend on ESEARCH capability)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$esearch_count(flag, use_uid = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>flag</code></dt><dd><p>A mandatory parameter that specifies one or more flags as a
filter to the counting operation. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A numeric <code>vector</code> of length <code>1</code> containing the number
  of messages in the folder that meet the specified criteria.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# count the number of messages marked as "Flagged" and "Answered"
con$esearch_count(flag = c("Flagged", "Answered"))
}
</pre>
</div>
    <p><hr>
<a id="method-delete_msg"></a></p><h3>Method <code>delete_msg()</code></h3>
    Delete message(s) in the selected mail folder
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$delete_msg(msg_id, use_uid = FALSE, mute = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    An invisible <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# delete
con$delete_msg(flag = c("Flagged", "Answered"))
}
</pre>
</div>
    <p><hr>
<a id="method-expunge"></a></p><h3>Method <code>expunge()</code></h3>
    Expunge the selected mail folder or specific message(s) (by UID)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$expunge(msg_uid = NULL, mute = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_uid</code></dt><dd><p>A <code>numeric vector</code> containing one or more messages UIDs.
Only UIDs are allowed in this operation (note the "u" in msg_<em>u</em>id).</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    <code>TRUE</code> if the operation is successful.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# count the number of messages marked as "Flagged" and "Answered"
con$esearch_count(flag = c("Flagged", "Answered"))
}
</pre>
</div>
    <p><hr>
<a id="method-esearch_min_id"></a></p><h3>Method <code>esearch_min_id()</code></h3>
    Search the minimum message id in the selected mail folder
  (depend on ESEARCH capability)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$esearch_min_id(flag, use_uid = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>flag</code></dt><dd><p>A mandatory parameter that specifies one or more flags as a
filter to the searching operation. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A numeric <code>vector</code> of length <code>1</code> containing the minimum
  message id in the folder.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# Search the minimum id of messages marked as "Answered"
con$esearch_min_id(flag = "Answered")
}
</pre>
</div>
    <p><hr>
<a id="method-esearch_max_id"></a></p><h3>Method <code>esearch_max_id()</code></h3>
    Search the maximum message id in the selected mail folder
  (depend on ESEARCH capability)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$esearch_max_id(flag, use_uid = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>flag</code></dt><dd><p>A mandatory parameter that specifies one or more flags as a
filter to the searching operation. Use <a href='#method-list_flags'><code>ImapCon$list_flags()</code></a>
to list the flags in a selected mail folder.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, results will be
presented as message sequence numbers. A message sequence number is a
message's relative position to the oldest message in a mail folder. It may
change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier,
and results are presented as such. UIDs are always the same during the
life cycle of a message in a mail folder.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A numeric <code>vector</code> of length <code>1</code> containing the maximum
  message id in the folder.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# Search the minimum id of messages marked as "Seen"
con$esearch_max_id(flag = "Seen")
}
</pre>
</div>
    <p><hr>
<a id="method-add_flags"></a></p><h3>Method <code>add_flags()</code></h3>
    Add flags to one or more messages
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$add_flags(
  msg_id,
  use_uid = FALSE,
  flags_to_set,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>flags_to_set</code></dt><dd><p>A <code>character vector</code> containing one or more flag
names to add to the specified message ids. If the flag to be set is a
system flag, such as <code>\SEEN</code>, <code>\ANSWERED</code>, the name should be
preceded by two backslashes <code>\</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    An invisible <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# Add the "\Seen" permanent flag to the messages received in the last hour
con$search_younger_than(seconds = 3600) %&gt;% # depends on the WITHIN extension
  con$add_flags(flags_to_set = "\\Seen")
}
</pre>
</div>
    <p><hr>
<a id="method-replace_flags"></a></p><h3>Method <code>replace_flags()</code></h3>
    Replace the current flags of one or more messages
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$replace_flags(
  msg_id,
  use_uid = FALSE,
  flags_to_set,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>flags_to_set</code></dt><dd><p>A <code>character vector</code> containing one or more flag
names that will replace the current ones. If the flag to be set is a
system flag, such as <code>\SEEN</code>, <code>\ANSWERED</code>, the name should be
preceded by two backslashes <code>\</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    An invisible <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# Replace the current flags of the messages in the search results for the
#.. flags "\UNSEEN" and "\Flagged"
con$search_since(date_char = "20-Aug-2020") %&gt;%
  con$replace_flags(flags_to_set = c("\\UNSEEN", "\\Flagged")
}
</pre>
</div>
    <p><hr>
<a id="method-remove_flags"></a></p><h3>Method <code>remove_flags()</code></h3>
    Remove flag(s) of one or more messages
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$remove_flags(
  msg_id,
  use_uid = FALSE,
  flags_to_unset,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>flags_to_unset</code></dt><dd><p>A <code>character vector</code> containing one or more
flag names that will be unset (removed). If the flag to be removed is a
system flag, such as <code>\SEEN</code>, <code>\ANSWERED</code>, the name should be
preceded by two backslashes <code>\</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command.
Default is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    An invisible <code>numeric vector</code> containing the message ids.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# Remove the the "\SEEN" flag from the messages in the search result
con$search_since(date_char = "20-Aug-2020") %&gt;%
  con$remove_flags(flags_to_unset = "\\UNSEEN")
}
</pre>
</div>
    <p><hr>
<a id="method-get_attachments"></a></p><h3>Method <code>get_attachments()</code></h3>
    Extract attached file(s) from fetched message(s)
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$get_attachments(
  msg_list,
  content_disposition = "both",
  override = FALSE,
  mute = FALSE
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_list</code></dt><dd><p>A <code>list</code> with the body or text content of the messages
fetched with <a href='#method-fetch_body'><code>ImapCon$fetch_body()</code></a> or
<a href='#method-fetch_text'><code>ImapCon$fetch_text()</code></a>.</p></dd>
    <dt><code>content_disposition</code></dt><dd><p>A <code>string</code> indicating which type of
"Content-Disposition" attachments should be retrieved. Default is
<code>"both"</code>, which retrieves regular attachments ("Content-Disposition:
attachment") and  inline attachments ("Content-Disposition: inline").</p></dd>
    <dt><code>override</code></dt><dd><p>A <code>logical</code>. Provides a confirmation message if the
command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    <code>TRUE</code> if the operation is successful. The files are saved
locally.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
# example 1
con$select_folder(name = "INBOX")
con$search_string(expr = "@gmail", where = "CC") %&gt;%
  con$fetch_text(write_to_disk = TRUE) %&gt;% # saving the message's content as txt files
  con$get_attachments()
    # example 2
res &lt;- con$search_string(expr = "@gmail", where = "CC") %&gt;%
out &lt;- con$fetch_body(msg = res)
con$get_attachments(msg_list = out)
}
</pre>
</div>
    <p><hr>
<a id="method-fetch_attachments_list"></a></p><h3>Method <code>fetch_attachments_list()</code></h3>
    Fetch attachments' list
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$fetch_attachments_list(msg_id, use_uid = FALSE, retries = 1)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command. Default
is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> with the fetch contents.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and fetch the attachments' list of the messages
out &lt; con$search_string(expr = "@k-state.edu", where = "FROM") %&gt;%
  con$fetch_attachments_list()
out
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "FROM")
out &lt;- con$fetch_attachments_list(msg = res)
out
    }
</pre>
</div>
    <p><hr>
<a id="method-fetch_attachments"></a></p><h3>Method <code>fetch_attachments()</code></h3>
    Fetch message attachments
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$fetch_attachments(
  msg_id,
  use_uid = FALSE,
  content_disposition = "both",
  override = FALSE,
  mute = FALSE,
  retries = 1
)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>msg_id</code></dt><dd><p>A <code>numeric vector</code> containing one or more message ids.</p></dd>
    <dt><code>use_uid</code></dt><dd><p>Default is <code>FALSE</code>. In this case, the operation will
be performed using message sequence numbers. A message sequence number
is a message's relative position to the oldest message in a mail folder.
It may change after deleting or moving messages. If a message is deleted,
sequence numbers are reordered to fill the gap. If <code>TRUE</code>, the
command will be performed using the <code>"UID"</code> or unique identifier.
UIDs are always the same during the life cycle of a message in a mail folder.</p></dd>
    <dt><code>content_disposition</code></dt><dd><p>A <code>string</code> indicating which type of
"Content-Disposition" attachments should be retrieved. The options are
<code>both</code>, <code>attachment</code>, and <code>inline</code>. Default is
<code>"both"</code>, which retrieves regular attachments ("Content-Disposition:
attachment") and  inline attachments ("Content-Disposition: inline").</p></dd>
    <dt><code>override</code></dt><dd><p>A <code>logical</code>. Provides a confirmation message if the
command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>mute</code></dt><dd><p>A <code>logical</code>. If <code>TRUE</code>, mutes the confirmation message
when the command is successfully executed. Default is <code>FALSE</code>.</p></dd>
    <dt><code>retries</code></dt><dd><p>Number of attempts to connect and execute the command. Default
is <code>1</code>.</p></dd>
</dl>
</div>
    <h3>Returns</h3>
    A <code>list</code> with the fetch contents.
    <h3>Examples</h3>
    <div class="r example copy">
<pre>\dontrun{
con$select_folder(name = "INBOX")
# do a search and fetch the attachments' list of the messages
con$search_string(expr = "@k-state.edu", where = "FROM") %&gt;%
  con$fetch_attachments() # the attachments will be downloaded to disk
    # or using a traditional approach
res &lt;- con$search_string(expr = "@k-state.edu", where = "FROM")
con$fetch_attachments(msg = res)
    }
</pre>
</div>
    <p><hr>
<a id="method-clone"></a></p><h3>Method <code>clone()</code></h3>
    The objects of this class are cloneable with this method.
<h3>Usage</h3>
    <div class="r"><pre>ImapCon$clone(deep = FALSE)</pre></div>
    <h3>Arguments</h3>
    <div class="arguments">
<dl class='dl-horizontal'>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>
</dl>
</div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># w/ Plain authentication</span>
<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='no'>ImapCon</span>$<span class='fu'>new</span>(
  <span class='kw'>url</span><span class='kw'>=</span><span class='st'>"imaps://outlook.office365.com"</span>,
  <span class='kw'>username</span><span class='kw'>=</span><span class='st'>"user@agency.gov.br"</span>,
  <span class='kw'>password</span><span class='kw'>=</span><span class='kw pkg'>rstudioapi</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/rstudioapi/topics/askForPassword'>askForPassword</a></span>(),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># w/ OAuth2.0 authentication</span>
<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='no'>ImapCon</span>$<span class='fu'>new</span>(
  <span class='kw'>url</span><span class='kw'>=</span><span class='st'>"imaps://outlook.office365.com"</span>,
  <span class='kw'>username</span><span class='kw'>=</span><span class='st'>"user@agency.gov.br"</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>xoauth2_bearer</span> <span class='kw'>=</span> <span class='st'>"XX.Ya9..."</span>)
<span class='co'># }</span><div class='input'>


## ------------------------------------------------
## Method `ImapCon$list_server_capabilities`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>cap</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>list_server_capabilities</span>()
<span class='no'>cap</span>
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$list_mail_folders`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>folders</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>list_mail_folders</span>()
<span class='no'>folders</span>
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$select_folder`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_mail_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$examine_folder`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='no'>con</span>$<span class='fu'>examine_folder</span>()

<span class='co'># or directly:</span>
<span class='no'>con</span>$<span class='fu'>examine_folder</span>(<span class='st'>"Sent"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$create_folder`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>create_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"New Folder Name"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$rename_folder`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"Folder A"</span>)
<span class='no'>con</span>$<span class='fu'>rename_folder</span>(<span class='kw'>new_name</span> <span class='kw'>=</span> <span class='st'>"Folder B"</span>)
<span class='co'># or directly:</span>
<span class='no'>con</span>$<span class='fu'>rename_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"Folder A"</span>, <span class='kw'>new_name</span> <span class='kw'>=</span> <span class='st'>"Folder B"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$list_flags`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='no'>con</span>$<span class='fu'>list_flags</span>()
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># ex1</span>
<span class='no'>con</span>$<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/search'>search</a></span>(<span class='fu'><a href='OR.html'>OR</a></span>(<span class='fu'><a href='before.html'>before</a></span>(<span class='kw'>date_char</span> <span class='kw'>=</span> <span class='st'>"17-Apr-2015"</span>),
              <span class='fu'><a href='string.html'>string</a></span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"John"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)))

<span class='co'># ex2</span>
<span class='no'>con</span>$<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/search'>search</a></span>(<span class='fu'><a href='AND.html'>AND</a></span>(<span class='fu'><a href='smaller_than.html'>smaller_than</a></span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='st'>"512000"</span>),
               <span class='fu'><a href='string.html'>string</a></span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"John"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>),
               <span class='fu'><a href='string.html'>string</a></span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@ksu.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"CC"</span>)))
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_larger_than`
## ------------------------------------------------

</div># NOT RUN {
# search for messages with size larger than 512Kb
con$search_larger_than(size = 512000))
# }
<div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_smaller_than`
## ------------------------------------------------

</div># NOT RUN {
con$select_folder(name = "INBOX")
# search for messages with size smaller than 512Kb
con$search_smaller_than(size = 512000))
# }
<div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_before`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for messages with date before "02-Jan-2020", presenting the</span>
<span class='co'># .. results as unique identifiers (UID)</span>
<span class='no'>con</span>$<span class='fu'>search_before</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='st'>"02-Jan-2020"</span>, <span class='kw'>use_uid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_since`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for messages with date since "02-Jan-2020", presenting the</span>
<span class='co'># .. results as unique identifiers (UID)</span>
<span class='no'>con</span>$<span class='fu'>search_since</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='st'>"02-Jan-2020"</span>, <span class='kw'>use_uid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_on`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for messages received on date "02-Jan-2020", presenting the</span>
<span class='co'>#... results as unique identifiers (UID)</span>
<span class='no'>con</span>$<span class='fu'>search_on</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='st'>"02-Jan-2020"</span>, <span class='kw'>use_uid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_period`
## ------------------------------------------------

</div># NOT RUN {
con$select_folder(name = "INBOX")
# search for all messages in the mail folder, EXCEPT (negate = TRUE) by
#... those received between the dates "02-Jan-2020" and "22-Mar-2020"
con$search_period(since_date_char = "02-Jan-2020",
                  before_date_char = "22-Mar-2020",
                  negate = TRUE))
# }
<div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_sent_before`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='co'># search for messages with date before "02-Jan-2020", presenting the</span>
<span class='co'># .. results as unique identifiers (UID)</span>
<span class='no'>con</span>$<span class='fu'>search_sent_before</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='st'>"02-Jan-2020"</span>, <span class='kw'>use_uid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_sent_since`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='co'># search for messages with date before "02-Jan-2020", presenting the</span>
<span class='co'># .. results as unique identifiers (UID)</span>
<span class='no'>con</span>$<span class='fu'>search_sent_since</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='st'>"02-Jan-2020"</span>, <span class='kw'>use_uid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_sent_on`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for messages received on date "02-Jan-2020", presenting the</span>
<span class='co'>#... results as unique identifiers (UID)</span>
<span class='no'>con</span>$<span class='fu'>search_sent_on</span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='st'>"02-Jan-2020"</span>, <span class='kw'>use_uid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_sent_period`
## ------------------------------------------------

</div># NOT RUN {
con$select_folder(name = "INBOX")
# search for all messages in the mail folder, EXCEPT (negate = TRUE) by
#... those received between the dates "02-Jan-2020" and "22-Mar-2020"
con$search_sent_period(since_date_char = "02-Jan-2020",
                  before_date_char = "22-Mar-2020",
                  negate = TRUE))
# }
<div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_flag`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for all messages in the mail folder that are marked as "SEEN" AND</span>
<span class='co'>#.. "ANSWERED"</span>
<span class='no'>con</span>$<span class='fu'>search_flag</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"SEEN"</span>, <span class='st'>"ANSWERED"</span>))
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_older_than`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for all messages received in the last hour (not older than 3600 seconds)</span>
<span class='no'>con</span>$<span class='fu'>search_older_than</span>(<span class='kw'>seconds</span> <span class='kw'>=</span> <span class='fl'>3600</span>, <span class='kw'>negate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_younger_than`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for all messages received in the last hour (younger than 3600 seconds)</span>
<span class='no'>con</span>$<span class='fu'>search_younger_than</span>(<span class='kw'>seconds</span> <span class='kw'>=</span> <span class='fl'>3600</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$search_string`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># search for all messages received in the last hour (younger than 3600 seconds)</span>
<span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$fetch_body`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and fetch the results (saving to disk) using the pipe</span>
<span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>fetch_body</span>(<span class='kw'>write_to_disk</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>keep_in_mem</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)

<span class='no'>con</span>$<span class='fu'>fetch_body</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>, <span class='kw'>write_to_disk</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>keep_in_mem</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$fetch_header`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and fetch the results (also saving to disk) using the pipe</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"CC"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>fetch_header</span>()

<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"CC"</span>)
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>fetch_header</span>()

<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$fetch_metadata`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and fetch the results using the pipe</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>fetch_metadata</span>()

<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>fetch_metadata</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>)

<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$fetch_text`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and partially fetch the results using the pipe</span>
<span class='co'># first 200 characters, writing to disk, silence results in the console</span>
<span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>fetch_text</span>(<span class='kw'>partial</span> <span class='kw'>=</span> <span class='st'>"0.200"</span>,
                 <span class='kw'>write_to_disk</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                 <span class='kw'>keep_in_mem</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)
<span class='no'>con</span>$<span class='fu'>fetch_text</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>,
               <span class='kw'>partial</span> <span class='kw'>=</span> <span class='st'>"0.200"</span>,
               <span class='kw'>write_to_disk</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
               <span class='kw'>keep_in_mem</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$copy_msg`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and copy the results to another folder</span>
<span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>copy</span>(<span class='kw'>to_folder</span> <span class='kw'>=</span> <span class='st'>"Sent"</span>)

<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)
<span class='no'>con</span>$<span class='fu'>copy</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>, <span class='kw'>to_folder</span> <span class='kw'>=</span> <span class='st'>"Sent"</span>)

<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$move_msg`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and copy the results to another folder</span>
<span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>move</span>(<span class='kw'>to_folder</span> <span class='kw'>=</span> <span class='st'>"Sent"</span>)

<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)
<span class='no'>con</span>$<span class='fu'>move</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>, <span class='kw'>to_folder</span> <span class='kw'>=</span> <span class='st'>"Sent"</span>)

<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$esearch_count`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># count the number of messages marked as "Flagged" and "Answered"</span>
<span class='no'>con</span>$<span class='fu'>esearch_count</span>(<span class='kw'>flag</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"Flagged"</span>, <span class='st'>"Answered"</span>))
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$delete_msg`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># delete</span>
<span class='no'>con</span>$<span class='fu'>delete_msg</span>(<span class='kw'>flag</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"Flagged"</span>, <span class='st'>"Answered"</span>))
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$expunge`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># count the number of messages marked as "Flagged" and "Answered"</span>
<span class='no'>con</span>$<span class='fu'>esearch_count</span>(<span class='kw'>flag</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"Flagged"</span>, <span class='st'>"Answered"</span>))
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$esearch_min_id`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># Search the minimum id of messages marked as "Answered"</span>
<span class='no'>con</span>$<span class='fu'>esearch_min_id</span>(<span class='kw'>flag</span> <span class='kw'>=</span> <span class='st'>"Answered"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$esearch_max_id`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># Search the minimum id of messages marked as "Seen"</span>
<span class='no'>con</span>$<span class='fu'>esearch_max_id</span>(<span class='kw'>flag</span> <span class='kw'>=</span> <span class='st'>"Seen"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$add_flags`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># Add the "\Seen" permanent flag to the messages received in the last hour</span>
<span class='no'>con</span>$<span class='fu'>search_younger_than</span>(<span class='kw'>seconds</span> <span class='kw'>=</span> <span class='fl'>3600</span>) <span class='kw'>%&gt;%</span> <span class='co'># depends on the WITHIN extension</span>
  <span class='no'>con</span>$<span class='fu'>add_flags</span>(<span class='kw'>flags_to_set</span> <span class='kw'>=</span> <span class='st'>"\\Seen"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$replace_flags`
## ------------------------------------------------

</div># NOT RUN {
con$select_folder(name = "INBOX")
# Replace the current flags of the messages in the search results for the
#.. flags "\UNSEEN" and "\Flagged"
con$search_since(date_char = "20-Aug-2020") %>%
  con$replace_flags(flags_to_set = c("\\UNSEEN", "\\Flagged")
# }
<div class='input'>
## ------------------------------------------------
## Method `ImapCon$remove_flags`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># Remove the the "\SEEN" flag from the messages in the search result</span>
<span class='no'>con</span>$<span class='fu'>search_since</span>(<span class='kw'>date_char</span> <span class='kw'>=</span> <span class='st'>"20-Aug-2020"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>remove_flags</span>(<span class='kw'>flags_to_unset</span> <span class='kw'>=</span> <span class='st'>"\\UNSEEN"</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$get_attachments`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='co'># example 1</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@gmail"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"CC"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>fetch_text</span>(<span class='kw'>write_to_disk</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='kw'>%&gt;%</span> <span class='co'># saving the message's content as txt files</span>
  <span class='no'>con</span>$<span class='fu'>get_attachments</span>()

<span class='co'># example 2</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@gmail"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"CC"</span>) <span class='kw'>%&gt;%</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>fetch_body</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>)
<span class='no'>con</span>$<span class='fu'>get_attachments</span>(<span class='kw'>msg_list</span> <span class='kw'>=</span> <span class='no'>out</span>)
<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$fetch_attachments_list`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and fetch the attachments' list of the messages</span>
<span class='no'>out</span> <span class='kw'>&lt;</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>fetch_attachments_list</span>()
<span class='no'>out</span>

<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>fetch_attachments_list</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>)
<span class='no'>out</span>

<span class='co'># }</span><div class='input'>
## ------------------------------------------------
## Method `ImapCon$fetch_attachments`
## ------------------------------------------------

</div><span class='co'># NOT RUN {</span>
<span class='no'>con</span>$<span class='fu'>select_folder</span>(<span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"INBOX"</span>)
<span class='co'># do a search and fetch the attachments' list of the messages</span>
<span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>) <span class='kw'>%&gt;%</span>
  <span class='no'>con</span>$<span class='fu'>fetch_attachments</span>() <span class='co'># the attachments will be downloaded to disk</span>


<span class='co'># or using a traditional approach</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>con</span>$<span class='fu'>search_string</span>(<span class='kw'>expr</span> <span class='kw'>=</span> <span class='st'>"@k-state.edu"</span>, <span class='kw'>where</span> <span class='kw'>=</span> <span class='st'>"FROM"</span>)
<span class='no'>con</span>$<span class='fu'>fetch_attachments</span>(<span class='kw'>msg</span> <span class='kw'>=</span> <span class='no'>res</span>)

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>

      <li><a href="#methods">Methods</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Allan Quadros.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

